<!DOCTYPE html>
<html lang="it" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="icon" href="/images/favicon.png" type="image/png" />
    <meta name="theme-color" content="#70b1bb">
    <meta name="author" content="Pietrantuono Alfio">
    <link rel="stylesheet" type="text/css" href="/css/md-layout.css" />
    <link rel="stylesheet" type="text/css" href="/css/material-icons.css" />
    <link rel="stylesheet" type="text/css" href="/css/md-loader.css" />
    <link rel="stylesheet" type="text/css" href="/css/md-controls.css" />
    <link rel="stylesheet" type="text/css" href="/css/md-drawer.css" />
    <link rel="stylesheet" type="text/css" href="/css/md-inputs.css" />
    <link rel="stylesheet" type="text/css" href="/css/report-layout.css" />
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/layouts.css" />
    <link rel="stylesheet" type="text/css" href="css/timeline.css" />
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="/js/Application.js"></script>
    <!-- <script src="/js/Timeline.js"></script> -->
    <script src="/js/lib.js"></script>
    <script src="/js/Storage.js"></script>
    <script src="/js/Page.js"></script>
    <script src="/js/Cube.js"></script>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0">
    <title>Mapping Database</title>
  </head>
  <body>

    <dialog id="cube-name">
      <div class="dialog-save-name">

        <div class="md-field">
          <input type="text" id="cubeName" value=""/>
          <label for="cubeName" class="">Titolo Cubo</label>
        </div>

      </div>

      <div class="dialog-buttons">
        <button type="button" name="cancel" class="md-button">annulla</button>
        <button id="btnCubeSaveName" type="button" name="done" class="md-button">Salva</button>
      </div>

    </dialog>

    <dialog id="dimension-name">
      <div class="dialog-save-name">

        <div class="md-field">
          <input type="text" id="dimensionName" value=""/>
          <label for="dimensionName" class="">Titolo dimensione</label>
        </div>

      </div>

      <div class="dialog-buttons">
        <button type="button" name="cancel" class="md-button">annulla</button>
        <button id="btnDimensionSaveName" type="button" name="done" class="md-button">Salva</button>
      </div>

    </dialog>

    <!-- <dialog id="hierarchy-name">
      <div class="dialog-save-name">

        <div class="md-field">
          <input type="text" id="hierarchyName" value=""/>
          <label for="hierarchyName" class="">Titolo Gerarchia</label>
        </div>

      </div>

      <div class="dialog-buttons">
        <button type="button" name="cancel" class="md-button">annulla</button>
        <button id="btnHierarchySaveName" type="button" name="done" class="md-button">Salva</button>
      </div>
    </dialog> -->

    <dialog id="column-setting" class="dialog-columns">
      <section>
        <h4>Formattazione e alias di colonna <span id="fieldName" class="highlight"></span></h4>

        <div class="name-alias">

          <div class="md-field">
            <input type="text" id="alias-column" value=""/>
            <label for="alias-column" class="">Alias</label>
          </div>
        </div>

        <div class="formulaDefine">

          <section class="formula">
            <textarea name="columnFormat" rows="8" cols="80"></textarea>

          </section>

        </div>

        <div class="dialog-buttons">
          <button type="button" name="cancel" class="md-button">annulla</button>
          <button id="btnColumnDone" type="button" name="done" class="md-button">ok</button>
        </div>

      </section>

    </dialog>

    <dialog id="groupby-setting" class="dialog-groupby">
      <section>
        <h4>Formattazione personalizzata GroupBy per <span id="fieldName" class="highlight"></span></h4>

        <div class="formulaDefine">

          <section class="formula">
            <textarea name="groupbyFormat" rows="8" cols="80"></textarea>
          </section>

        </div>



        <div class="dialog-buttons">
          <button type="button" name="cancel" class="md-button">annulla</button>
          <button id="btnGroupByDone" type="button" name="done" class="md-button">ok</button>
        </div>

      </section>

    </dialog>

    <dialog id="filter-setting" class="dialog-filters">
      <section>
        <h4>Inserisci qui la condizione di filtro
        <div class="md-field">
          <input type="text" id="filter-name" value=""/>
          <label for="filter-name" class="">Nome</label>
        </div>

        <div class="formulaDefine">

          <section class="formula">
            <div class="title">
              <h6>Colonne</h6><small>Seleziona le colonne da filtrare</small>
            </div>

            <div class="listContent">
              <div class="md-field" value>
                <input type="search" id="fieldSearch" value=""/>
                <label for="fieldSearch" class="">Ricerca</label>
              </div>
              <ul id="fieldsList" class="middleList"></ul>
            </div>
          </section>

          <section class="formula">
            <div class="title">
              <h6>SQL operatori</h6><small>Scorri la lista degli operatori</small>
            </div>

            <div class="listContent">
              <ul id="operator-list" class="miniList">
                <li label="=">&equals;</li>
                <li label="<>">&lt;&gt;</li>
                <li label="<">&lt;</li>
                <li label=">">&gt;</li>
                <li label="<=">&lt;&equals;</li>
                <li label=">=">&gt;&equals;</li>
                <li label="BETWEEN AND">BETWEEN&nbsp;AND&nbsp;</li>
                <li label="IN">IN</li>
                <li label="NOT IN">NOT IN</li>
                <li label="IS NULL">IS NULL</li>
                <li label="IS NOT NULL">IS NOT NULL</li>
              </ul>
            </div>
          </section>
          <!-- TODO: rinominare la .formula in section.... -->
          <section class="formula">
            <div class="title">
              <h6>Lista valori</h6><small>Seleziona i valori per creare il filtro</small>
            </div>

            <div id="filterValuesList" class="valuesList" hidden>
              <div class="listContent">
                <div class="md-field" value>
                  <input type="search" id="valuesSearch" value=""/>
                  <label for="valuesSearch" class="">Ricerca</label>
                </div>
                <ul id="valuesList" class="middleList"></ul>
              </div>
            </div>

          </section>

        </div>

        <div class="formulaDefined">
          <div class="logicalOperator">
            <span>AND</span>
            <span>OR</span>
            <span>AND NOT</span>
            <span>OR NOT</span>
          </div>

          <div class="formulaContent">
            <div id="filterFormula" class="textarea">
              <!-- <span class="formulaField">id</span>
              <span class="formulaOperator"> =</span>
              <span class="formulaValues">443</span> -->
            </div>
            <div class="formulaIcons">
              <span class="popupContent"><i class="material-icons md-18">clear</i><small class="popup">Rimuovi</small></span>
              <span class="popupContent"><i class="material-icons md-18">edit</i><small class="popup">Modifica</small></span>
            </div>
          </div>

        </div>

        <div class="dialog-buttons">
          <button type="button" name="cancel" class="md-button">annulla</button>
          <button id="btnFilterDone" type="button" name="done" class="md-button" disabled>ok</button>
        </div>
      </section>
    </dialog>

    <dialog id="metric-setting" class="dialog-metrics">
      <section>
        <h4>Inserisci qui la funzione per la metrica <span id="fieldName" class="highlight"></span></h4>

        <div class="name-alias">
          <div class="md-field">
            <input type="text" id="metric-name" value=""/>
            <label for="metric-name" class="">Nome</label>
          </div>

          <div class="md-field">
            <input type="text" id="alias-metric" value=""/>
            <label for="alias-metrics" class="">Alias</label>
          </div>
        </div>

        <div class="formulaDefine">

          <section class="formula">
            <h6>SQL Function</h6><small>Scorri la lista delle SQL function</small>
            <div class="listContent">
              <ul id="function-list" class="miniList">
                <li id="0" selected>SUM</li>
                <li id="1">COUNT</li>
                <li id="2">AVG</li>
                <li id="3">MAX</li>
                <li id="4">MIN</li>
              </ul>
            </div>
            <label class="mdc-checkbox">
              <input id="checkbox-distinct" type="checkbox" name="distinct-checkbox"/>
              <span>DISTINCT</span>
            </label>

          </section>


          <section class="filtersList">
            <h6>Lista Filtri</h6><small>Filtri da applicare alla metrica</small>
            <div class="listContent">
              <ul id="metric-filters"></ul>
            </div>

          </section>

        </div>

        <div class="dialog-buttons">
          <button type="button" name="cancel" class="md-button">annulla</button>
          <button id="btnMetricDone" type="button" name="done" class="md-button">ok</button>
        </div>

      </section>


      <!-- <div> -->
      <!-- TODO: si può aggiungere in futuro per filtri più complessi -->
        <!-- <textarea id="sql-filter" name="sql" rows="5" cols="33" placeholder="Inserisci qui la condizione di filtro"></textarea>
      </div> -->
    </dialog>

    <dialog id="dialog-report-list">
      <div class="lists">
        <div class="list">
          <div class="md-field">
            <input type="search" id="cubeSearch" value=""/>
            <label for="cubeSearch" class="">Ricerca</label>
          </div>

          <ul id="cubesList"></ul>
        </div>
      </div>
    </dialog>

    <dialog id="dialog-col-setting">
      <section>
        <h4>personalizzazione colonna</h4>
        <input type="checkbox" name="colHidden" checked="false">Visualizza/Nascondi

      </section>
    </dialog>

    <template id="cardLayout">
      <div class="cardLayout">
        <section class="cardTable">
          <div class="title">
            <h6></h6>
            <span data-id="popupCloseTable" class="popupContent"><i data-id="closeTable" class="material-icons md-18">close</i><small class="popup">Chiudi</small></span>
          </div>
          <div class="md-field">
            <input type="search" value=""/>
            <label for="searchColumns" class="">Ricerca</label>
          </div>
          <ul id="columns" hidden></ul>
          <div class="info" hidden></div>
        </section>
        <section options>
          <span class="popupContent"><i class="material-icons md-18" columns>view_list</i><small class="popup">Colonna</small></span>
          <span class="popupContent"><i class="material-icons md-18" filters>filter_list</i><small class="popup">Filtro</small></span>
          <span class="popupContent"><i class="material-icons md-18" groupby>dynamic_feed</i><small class="popup">Raggruppamento</small></span>
          <span class="popupContent"><i class="material-icons md-18" metrics>show_chart</i><small class="popup">Metrica</small></span>
          <br>
          <span class="popupContent"><i class="material-icons md-18" hierarchies>insert_link</i><small class="popup">Crea Relazione</small></span>
          <span class="popupContent"><i class="material-icons md-18" hierarchies-left>flip</i><small class="popup">Left Join</small></span>
          <span class="popupContent"><i class="material-icons md-18" hierarchies-right>flip</i><small class="popup">Right Join</small></span>
          <span class="popupContent"><i class="material-icons md-18" hierarchies-remove>link_off</i><small class="popup">Rimuovi relazione</small></span>
        </section>

      </div>
    </template>

    <template id="el">
      <div class="element card" id="" draggable="true" label=""></div>
    </template>

    <template id="templateListColumns">
      <div class="element" name="">
        <li></li>
        <i id="hierarchy-icon" class="material-icons md-18">insert_link</i>
        <i id="columns-icon" class="material-icons md-18">view_list</i>
        <!-- <i id="filters-icon" class="material-icons md-18">filter_list</i> -->
        <i id="groupby-icon" class="material-icons md-18">dynamic_feed</i>
        <i id="metrics-icon" class="material-icons md-18">show_chart</i>
      </div>
    </template>

    <main>
      <div id="drawer">

        <section class="account"><h5>user</h5><i class="material-icons md-light">person</i></section>

        <nav>
          <template id="cubeList">
            <a href="#" title="" id=""><i class="material-icons">grid_on</i><span></span></a>
          </template>
          <!-- TODO: qui i cubi già salvati -->
          <!-- <a href="" title="Impostazioni"><i class="material-icons md-18">settings</i><span>Impostazioni</span></a> -->


        </nav>

      </div>

      <header>
        <div class="nav-button"> <!-- codelab-nav-button-->
          <a href="/" id="arrow-back"><i class="material-icons md-light">close</i></a>
          <a href="#" id="menu" onclick="App.menu()"><i class="material-icons md-light">menu</i></a>

        </div>

        <h1 class="title"></h1>
      </header>

      <div id="container" data-page="1">

        <div id="content"> <!--class="dropzone"-->

          <div id="body" hidden>
            <h2>Mapping</h2>
            <h5>Trascina qui le tabelle da aggiungere</h5>

            <div class="actions">
              <span class="popupContent"><i id="openTableList" class="material-icons md-24">view_list</i><small class="popup">Lista tabelle</small></span>
              <span class="popupContent"><i id="openDimensionList" class="material-icons md-24">view_list</i><small class="popup">Lista Dimensioni</small></span>
              <span class="popupContent"><i class="material-icons md-24">playlist_add</i><small class="popup">Nuova dimensione</small></span>
              <span class="popupContent"><i id="openReport" class="material-icons md-24 md-dark md-inactive">folder_open</i><small class="popup">Apri Report</small></span>
            </div>

            <div class="lists">
              <div class="absList" id="tableList" hidden>
                <div class="md-field">
                  <input type="search" id="tableSearch" value=""/>
                  <label for="tableSearch" class="">Ricerca</label>
                </div>
                <ul id="tables"></ul>
              </div>
            </div>

            <div class="lists">
              <template id="dimension">
                <div class="element dimensions">
                  <h5>dim title</h5>
                  <template id="miniCard"><div class="miniCard"><h6></h6></div></template>
                </div>
              </template>
              <div class="absList" id="dimensionList" hidden>
                <div class="md-field">
                  <input type="search" id="dimensionSearch" value=""/>
                  <label for="dimensionSearch" class="">Ricerca</label>
                </div>
                <ul id="dimensions"></ul>
              </div>
            </div>

            <section class="guide">
              <h5>Step</h5>
              <div id="step-1" class="steps" active>
                <span>1</span>
                <div class="step">
                  <span class="title">Definire i livelli dimensionali</span>
                  <small>Selezionare la tabelle per creare le dimensioni</small>
                </div>
              </div>
              <div id="step-2" class="steps">
                <span>2</span>
                <div class="step">
                  <span class="title">Struttura gerarchica</span>
                  <small>Definire la struttura gerarchica nell'elenco di destra. L'ultima tabella verrà associata alla FACT</small>
                </div>
              </div>
              <div id="step-3" class="steps">
                <span>3</span>
                <div class="step">
                  <span class="title">Imposta tabella Fact</span>
                  <small>Associare la dimensione al Cubo. E' possibile creare un nuovo cubo oppure selezionarlo dal menù laterale</small>
                </div>
              </div>
            </section>

            <div id="hierarchiesContainer" hidden>
              <section id="hierarchies">
                <h5>Struttura gerarchica</h5><h6>Gerarchia 1</h6>
                <div id="hierTables"></div>
                <span class="before"><span class="arrow"></span></span>
                <div class="association">
                  <p>Associazione con la Fact Table</p>
                </div>
                <span class="after"><span class="arrow"></span></span>
                <div id="hierFact">
                  <div>
                    <div class="hier fact">FACT TABLE</div>
                  </div>
                </div>
                <div class="actions">
                  <span class="popupContent"><i id="saveDimension" class="material-icons md-24 md-dark md-inactive">save</i><small class="popup">Salva dimensione</small></span>
                  <span class="popupContent"><i id="hierarchySave" class="material-icons md-24 md-dark md-inactive">save</i><small class="popup">Salva gerarchia</small></span>
                  <span class="popupContent"><i class="material-icons md-24">playlist_add</i><small class="popup">Nuova gerarchia</small></span>
                </div>

              </section>
            </div>

            <!-- <div id="dimensions"></div> -->

          </div>

        </div>

        <div id="controls">
          <div id="fabs">
            <button id="mdc-back" class="button dense raised">back</button>
            <div class="spacer"></div>
            <button id="mdc-newFact" class="button dense raised" hidden data-associated-page="1">Imposta nuovo Cubo</button>
            <button id="mdc-preview-report" class="button dense raised" hidden data-associated-page="2" disabled>report preview</button>
          </div>
        </div>

        <div id="console">
          <div id="fabsConsole">
            <i class="material-icons md-18">info</i>
            <p></p>
          </div>
        </div>

      </div>
    </main>

    <div class="loader">
      <svg viewBox="0 0 32 32" width="32" height="32">
        <circle id="spinner" cx="16" cy="16" r="14" fill="none"></circle>
      </svg>
    </div>

    <script type="text/javascript" src="js/init.js" async></script>
  </body>
</html>
